<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./css/style.css" />
    <script src="https://kit.fontawesome.com/05def4ad8f.js" crossorigin="anonymous"></script>
    <title>The Falconer</title>
  </head>
  <body>
    <nav id="navbar">
      <a class="title" href="index.html">
        <!-- <img src="./assets/falconer logo (1)_edited.webp" alt="" srcset="" /> -->
        <span>The Falconer</span>
      </a>
      <div class="menu_section">
        <input type="checkbox" id="sidebar-active" />
        <label for="sidebar-active" class="open-sidebar-button">
          <svg xmlns="http://www.w3.org/2000/svg" height="32" viewBox="0 -960 960 960" width="32">
            <path d="M120-240v-80h720v80H120Zm0-200v-80h720v80H120Zm0-200v-80h720v80H120Z" />
          </svg>
        </label>
        <div class="links-container">
          <label id="overlay" for="sidebar-active"></label>
          <menu>
            <label for="sidebar-active" class="close-sidebar-button">
              <svg xmlns="http://www.w3.org/2000/svg" height="32" viewBox="0 -960 960 960" width="32">
                <path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z" />
              </svg>
            </label>
            <li><a href="index.html" class="nav-link">Home</a></li>
            <li><a href="about.html" class="nav-link">About</a></li>
            <li><a href="submit.html" class="nav-link">Submit</a></li>
            <li><a href="archive.html" class="nav-link">Archive</a></li>
            <li><a href="join.html" class="nav-link">Join us</a></li>
            <li><a href="contact.html" class="nav-link">Contact us</a></li>
          </menu>
        </div>
      </div>
    </nav>

    <div class="main_container">
      <header>
        <div class="join_hero_section">
          <div class="content">
            <div class="container">
              <div class="banner">
                <h2>Apply</h2>
              </div>
            </div>
          </div>
        </div>
      </header>

      <section class="submit">
        <div class="submit_container">
          <div class="join_title">
            <h1>Join Our Team</h1>
            <p><span class="highlight">Welcome to our literary haven!</span></p>
            <p>
              We’re always on the lookout for passionate individuals to join our
              team. Whether you're a writer, editor, designer, or someone
              brimming with creative ideas, we want to hear from you! Together,
              let's shape stories, explore new perspectives, and inspire readers
              around the world.
            </p>
            <p><strong>“Literature exists as a bridge to the human experience.”</strong></p>
            <p>Join us in celebrating the art of storytelling.</p>
            <span class="horizontal_line"></span>
          </div>

          <div class="guidelines">
            <h2>How to Apply</h2>
            <p><strong>Submitting Your Application:</strong></p>
            <ul class="guide_points">
              <li>Complete the form below and include all required information.</li>
              <li>Attach your resume and portfolio or writing samples relevant to your desired role.</li>
              <li>Response times may vary from <strong>1-4 weeks</strong>. We’ll keep you updated through email or our social channels.</li>
            </ul>
            <span class="horizontal_line"></span>
          </div>

          <div class="guidelines">
            <p><strong>Guidelines for Submission:</strong></p>
            <ul>
              <li>Provide a brief introduction about yourself and your interest in joining our team.</li>
              <li>Share links to your previous works (if applicable).</li>
              <li>Be authentic! Let your love for literature and creativity shine.</li>
            </ul>
            <span class="horizontal_line"></span>
          </div>

          <div class="roles">
            <h2>Roles We’re Looking For:</h2>
            <ul>
              <li><strong>Writers & Contributors:</strong> Share your voice through essays, short stories, poetry, or critiques.</li>
              <li><strong>Editors:</strong> Help polish and refine submissions to uphold our standards of excellence.</li>
              <li><strong>Graphic Designers:</strong> Create captivating visuals that complement our literary content.</li>
              <li><strong>Social Media Specialists:</strong> Bring our magazine to life online, connecting us to a wider audience.</li>
              <li><strong>Event Organizers:</strong> Plan and execute literary events, workshops, and readings.</li>
            </ul>
            <span class="horizontal_line"></span>
          </div>

          <div class="values">
            <h2>Our Values</h2>
            <p>
              We celebrate diversity, creativity, and the courage to express
              oneself. <strong>We do not tolerate plagiarism or any form of bigotry.</strong>
              Our mission is to create a safe and inclusive space for all voices,
              and we ask that all applicants uphold these principles.
            </p>
            <span class="horizontal_line"></span>
            <h2>Ready to Join?</h2>
            <p>We can't wait to hear from you! Please fill out the form below to submit your application.</p>
          </div>

          <div class="submit_form">
            <form enctype="multipart/form-data" id="submitForm">
              <fieldset>
                <legend>Name <span class="forms_required_label">*</span></legend>
                <div class="field_row_container">
                  <div class="field_row">
                    <input type="text" id="firstName" name="first_name" placeholder="First Name" required />
                  </div>
                  <div class="field_row">
                    <input type="text" id="lastName" name="last_name" placeholder="Last Name" required />
                  </div>
                </div>
              </fieldset>

              <div class="form_field">
                <label>Email <span class="forms_required_label">*</span></label>
                <input type="email" name="email" id="email" placeholder="Your Email" required />
              </div>

              <div class="form_field">
                <label>Position Applying For <span class="forms_required_label">*</span></label>
                <select name="position" id="position" required>
                  <option value="" disabled selected>Select a Position</option>
                  <option value="Writer & Contributor">Writer & Contributor</option>
                  <option value="Editor">Editor</option>
                  <option value="Graphic Designer">Graphic Designer</option>
                  <option value="Social Media Specialist">Social Media Specialist</option>
                  <option value="Event Organizer">Event Organizer</option>
                </select>
              </div>

              <div class="form_field">
                <label>Tell us about yourself and your interest in joining our team <span class="forms_required_label">*</span></label>
                <textarea name="introduction" id="introduction" placeholder="Provide a brief introduction about yourself and your interest in joining our team." required></textarea>
              </div>

              <div class="form_field">
                <label>Share links to your previous works (if applicable)</label>
                <textarea name="previous_works" id="previousWorks" placeholder="Include links to your previous works, if applicable."></textarea>
              </div>

              <div id="form_fileUpload_field_9" class="field_fileUpload form_field form_field_container" data-field-type="fileUpload" data-field-id="9">
                <label class="field_label" for="form_fileUpload_field_9">Upload Your Resume <span class="forms_required_label">*</span></label>
                <div class="form_upload form_field" data-field-id="9">
                  <div class="uploadMessage form_field">
                    <svg viewBox="0 0 1024 1024" focusable="false" data-icon="inbox" width="50px" height="50px" fill="currentColor">
                      <path d="M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0 0 60.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"></path>
                    </svg>
                    <span class="messageTitle">Click or drag files to this area to upload.</span>
                    <span class="messageHint">You can upload up to 5 files.</span>
                  </div>
                  <div class="preview_upload" id="preview_upload" style="display: none"></div>
                </div>
                <input
                  type="file"
                  accept=".pdf, .doc, .docx, .xls, .xlsx, .ppt, .pptx, .odt, .odp, .ods, .rtf, .txt, .csv, .pages, .xps, .wpd"
                  autocomplete="off"
                  readonly
                  multiple
                  class="dropzone_input"
                  style="display: none; position: absolute !important; clip: rect(0, 0, 0, 0) !important; height: 1px !important; width: 1px !important; border: 0 !important; overflow: hidden !important; padding: 0 !important; margin: 0 !important;"
                  id="form_fileUpload_field_9_input"
                  name="form_fileUpload_field_9"
                  required
                />
                <em id="field_error" class="form_error" role="alert" style="display: none">This field is required</em>
              </div>

              <div class="form_field">
                <button type="submit" class="submit_button">Submit Application</button>
              </div>
            </form>
          </div>
        </div>
      </section>
    </div>

    <footer id="footer_back">
      <div class="container">
        <div class="footer_content">
          <div class="footer_title">
            <p>© 2024 Falconer. All rights reserved</p>
            <p>Designed by <span>hiiii</span></p>
          </div>
          <div class="links">
            <ul class="socials">
              <li><a href=""><i class="fa-brands fa-facebook"></i></a></li>
              <li><a href=""><i class="fa-brands fa-instagram"></i></a></li>
              <li><a href=""><i class="fa-brands fa-linkedin"></i></a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>

    <script>
      const navbar = document.getElementById("navbar");
      window.onscroll = function () {
        if (window.scrollY > 300) {
          navbar.classList.add("scrolled");
        } else {
          navbar.classList.remove("scrolled");
        }
      };
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const fileInput = document.getElementById("form_fileUpload_field_9_input");
        const form = document.getElementById("submitForm");
        const previewContainer = document.getElementById("preview_upload");
        const uploadMessage = document.querySelector(".uploadMessage");
        const fieldError = document.getElementById("field_error");

        uploadMessage.addEventListener("click", function () {
          fileInput.click();
        });

        fileInput.addEventListener("change", function (event) {
          const files = Array.from(event.target.files);
          const maxSizeMB = 10;
          for (const file of files) {
            if (file.size / 1024 / 1024 > maxSizeMB) {
              alert(`File ${file.name} exceeds ${maxSizeMB}MB limit.`);
              fileInput.value = '';
              return;
            }
          }
          if (files.length + previewContainer.children.length > 5) {
            alert("You can upload a maximum of 5 files.");
            return;
          }

          files.forEach((file) => {
            const reader = new FileReader();
            reader.uploadProgress = 0;

            const fileSizeMB = (file.size / (1024 * 1024)).toFixed(2);
            const fileName = file.name;

            const filePreview = document.createElement("div");
            filePreview.className = "file_preview";
            filePreview.style.position = "relative";
            filePreview.style.margin = "0 0 12px 0";
            filePreview.innerHTML = `
              <div class="preview_details" style="display: flex;">
                <div class="preview_filename" style="padding: 0 40px 0 10px;">
                  <span>${fileName}</span>
                </div>
                <div class="preview_size">
                  <span><strong>${fileSizeMB}</strong> MB</span>
                </div>
              </div>
              <div class="progress">
                <span class="upload_progress" id="upload_progress">0%</span>
                <div class="progress_bar" style="width: 0%;"></div>
              </div>
              <div class="preview_remove" style="position: absolute; right: 0; top: 0; cursor: pointer;">
                <div class="line" style="position: absolute; width: 2px; height: 20px; background: black; transform: rotate(45deg);"></div>
                <div class="line" style="position: absolute; width: 2px; height: 20px; background: black; transform: rotate(-45deg);"></div>
              </div>
            `;

            previewContainer.appendChild(filePreview);
            previewContainer.style.display = "block";

            let uploadProgress = 0;
            const progress = filePreview.querySelector("#upload_progress");
            const progressBar = filePreview.querySelector(".progress_bar");

            const progressInterval = setInterval(() => {
              if (uploadProgress < 100) {
                uploadProgress += 10;
                progress.textContent = uploadProgress + "%";
                progressBar.style.width = uploadProgress + "%";
              } else {
                clearInterval(progressInterval);
                setTimeout(() => {
                  removeProgress(filePreview);
                }, 1000);
              }
            }, 300);

            filePreview.querySelector(".preview_remove").addEventListener("click", function (e) {
              e.preventDefault();
              previewContainer.removeChild(filePreview);
              if (previewContainer.children.length === 0) {
                previewContainer.style.display = "none";
              }
            });

            reader.onload = function (e) {
              const base64String = e.target.result.split(",")[1];
            };
            reader.readAsDataURL(file);
          });
        });

        function removeProgress(filePreview) {
          const progressElement = filePreview.querySelector(".progress");
          if (progressElement) {
            progressElement.style.display = "none";
          }
        }

        form.addEventListener("submit", function (event) {
          event.preventDefault();
          fieldError.style.display = "none";

          if (fileInput.files.length === 0) {
            fieldError.style.display = "block";
            alert('Please upload at least one file.');
            return;
          }

          const data = {
            first_name: form.first_name.value,
            last_name: form.last_name.value,
            email: form.email.value,
            position: form.position.value,
            introduction: form.introduction.value,
            previous_works: form.previous_works.value || '',
            files: [],
          };

          const files = Array.from(fileInput.files);
          let fileLoaded = 0;

          files.forEach((file) => {
            const reader = new FileReader();
            reader.onload = function (e) {
              const base64String = e.target.result.split(",")[1];
              data.files.push({
                name: file.name,
                type: file.type,
                size: file.size,
                data: base64String,
              });
              fileLoaded++;
              if (fileLoaded === files.length) {
                submitForm(data, form);
              }
            };
            reader.readAsDataURL(file);
          });
        });

        async function submitForm(data, form) {
          try {
            const response = await fetch("http://localhost:5000/upload", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(data),
            });
            const result = await response.json(); // Parse JSON response
            if (response.ok) {
              form.reset();
              fileInput.value = "";
              previewContainer.innerHTML = "";
              previewContainer.style.display = "none";
              alert("Form submitted successfully!");
            } else {
              alert("Failed to submit the form.");
            }
          } catch (error) {
            console.error("Error submitting the form:", error);
            alert("An error occurred. Please try again.");
          }
        }
      });
    </script>
  </body>
</html>